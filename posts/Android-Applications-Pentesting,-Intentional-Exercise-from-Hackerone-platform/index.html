<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Android Applications Pentesting, Intentional Exercise from Hackerone platform" /><meta name="author" content="BaadMaro" /><meta property="og:locale" content="en" /><meta name="description" content="Today we are going to practice some Android pentesting with a challenge made by Hackerone platform." /><meta property="og:description" content="Today we are going to practice some Android pentesting with a challenge made by Hackerone platform." /><link rel="canonical" href="https://baadmaro.github.io/posts/Android-Applications-Pentesting,-Intentional-Exercise-from-Hackerone-platform/" /><meta property="og:url" content="https://baadmaro.github.io/posts/Android-Applications-Pentesting,-Intentional-Exercise-from-Hackerone-platform/" /><meta property="og:site_name" content="BaadMaro" /><meta property="og:image" content="https://baadmaro.github.io/assets/img/posts/hacker101.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-27T00:00:00+00:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://baadmaro.github.io/assets/img/posts/hacker101.jpg" /><meta property="twitter:title" content="Android Applications Pentesting, Intentional Exercise from Hackerone platform" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@BaadMaro" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"BaadMaro"},"dateModified":"2023-03-16T16:20:03+00:00","datePublished":"2022-07-27T00:00:00+00:00","description":"Today we are going to practice some Android pentesting with a challenge made by Hackerone platform.","headline":"Android Applications Pentesting, Intentional Exercise from Hackerone platform","image":"https://baadmaro.github.io/assets/img/posts/hacker101.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://baadmaro.github.io/posts/Android-Applications-Pentesting,-Intentional-Exercise-from-Hackerone-platform/"},"url":"https://baadmaro.github.io/posts/Android-Applications-Pentesting,-Intentional-Exercise-from-Hackerone-platform/"}</script><title>Android Applications Pentesting, Intentional Exercise from Hackerone platform | BaadMaro</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BaadMaro"><meta name="application-name" content="BaadMaro"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BaadMaro</a></div><div class="site-subtitle font-italic">My journey into hacking</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/BaadMaro" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Android Applications Pentesting, Intentional Exercise from Hackerone platform</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Android Applications Pentesting, Intentional Exercise from Hackerone platform</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1658880000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 27, 2022 </em> </span> <span> Updated <em class="" data-ts="1678983603" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 16, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> BaadMaro </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1729 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"> <img data-src="/assets/img/posts/hacker101.jpg" class="post-preview-img" data-proofer-ignore><p>Today we are going to practice some Android pentesting with a challenge made by Hackerone platform.</p><p>I’ll explain different techniques used in Android pentesting with a practical overview.</p><p>This article was made for the day 2 of the hack event organised by The Hacking News B’Darija.</p><h1 id="challenge">Challenge</h1><p>We can access the challenege using https://ctf.hacker101.com/ctf</p><p><img data-src="https://user-images.githubusercontent.com/72421091/181637405-27d78a8e-7947-48fe-9a33-e37b268dc46f.png" alt="image" data-proofer-ignore></p><h1 id="intentional-exercise-challenge-setup">Intentional Exercise Challenge setup</h1><p>https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>**Your Android APK is building. Please refresh in a few seconds.**
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/level13.apk
</pre></table></code></div></div><p>https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting</p><h1 id="instal-the-apk-using-bluestackes">Instal the apk using Bluestackes</h1><p>I didn’t have time to setup a clean setup for an Android emulator on my Linux machine, so i just used my Windows machine with Bluestacks emulator. It’s probably simple to setup Burpsuite proxy with it, right ? :unamused:</p><p>After installing the app, we can see it in your app menu.</p><p><img data-src="https://user-images.githubusercontent.com/72421091/181377629-016547e2-769e-4b96-b82e-06b7b2a04a4f.png" alt="Pasted image 20220727190015" data-proofer-ignore></p><h2 id="proxy-setup-with-burpsuite"><span class="mr-2">Proxy setup with Burpsuite</span><a href="#proxy-setup-with-burpsuite" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To intercept requests from our android app, I’ll use Burpsuite. You can use the community version it’s free https://portswigger.net/burp</p><p><img data-src="https://user-images.githubusercontent.com/72421091/181638498-8bf0ae76-918b-4f69-b94d-2fe37b19fa6d.png" alt="image" data-proofer-ignore></p><p>We need to set the proxy used by bluestackes using HD-ConfigHttpProxy.exe. You can find it in your application installation.</p><p><img data-src="https://user-images.githubusercontent.com/72421091/181377657-fbd62f1c-999e-433c-9fa7-ae8c1811cbb7.png" alt="Pasted image 20220727190717" data-proofer-ignore></p><p>Now let’s add our burp proxy.</p><p><img data-src="https://user-images.githubusercontent.com/72421091/181377676-a84012ad-11b9-49fa-a70d-7f93de9ac276.png" alt="Pasted image 20220727202122" data-proofer-ignore></p><p>After setting a proxy, you need to restart Bluestacks. You can use the reset option to go back to default settings.</p><p>Now we need to :</p><ul><li><p>Use BlueStacks Tweaker to root the emulator.</p><li><p>Install root certificate manager from the Google Play store.</p><li><p>Import the burp certificate. You can export it from the proxy tab.</p></ul><h1 id="intercept-requests-while-opening-the-app">Intercept requests while opening the app</h1><p>Before the app shows the webview, we can see a request to <code class="language-plaintext highlighter-rouge">https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot?&amp;hash=61f4518d844a9bd27bb971e55a23cd6cf3a9f5ef7f46285461cf6cf135918a1a</code></p><p><img data-src="https://user-images.githubusercontent.com/72421091/181378693-c9a67583-9443-439b-8d50-278c0ef219d3.png" alt="Pasted image 20220727202844" data-proofer-ignore></p><p>Here is the response : </p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="err">
</span><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>

Date: Wed, 27 Jul 2022 19:29:48 GMT

Content-Type: text/html; charset=utf-8

Content-Length: 64

Connection: close

Server: openresty/1.21.4.1

&lt;h1&gt;Welcome to Level13&lt;/h1&gt;&lt;a href="appRoot/flagBearer"&gt;Flag&lt;/a&gt;

</pre></table></code></div></div><p>After forwarding the requests, let’s see what happens after clicking “Flag.”</p><p><img data-src="https://user-images.githubusercontent.com/72421091/181377835-ffd71fa7-1ea6-48e5-ad1d-feba7f61226c.png" alt="Pasted image 20220727203135" data-proofer-ignore></p><p>We can see a new request to /appRoot/flagBearer same output as our first request. After forwarding the request, we see an output with an invalid request </p><p><img data-src="https://user-images.githubusercontent.com/72421091/181377854-3f23d74d-72a6-47a8-a473-183f762e4d4a.png" alt="Pasted image 20220727203253" data-proofer-ignore></p><p>Here is the response : </p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="err">
</span><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>

Date: Wed, 27 Jul 2022 19:32:18 GMT

Content-Type: text/html; charset=utf-8

Content-Length: 15

Connection: close

Server: openresty/1.21.4.1

Invalid request

</pre></table></code></div></div><p>Now let’s try to analyze what we were able to find :</p><ul><li><p>Leaked the used domain : 86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com</p><li><p>Hash parametre with /appRoot : hash=61f4518d844a9bd27bb971e55a23cd6cf3a9f5ef7f46285461cf6cf135918a1a</p><li><p>openresty/1.21.4.1 : Web server version. It’s probably the load blanacer https://openresty.org/en/</p><li><p>The app may be trying to verify a hash token with /appRoot to access/appRoot/flagBearer which is our final access.</p><li><p>We can check the links with our browser, It’s seems like the app is using a webview. We can get the same behavior.</p></ul><p><img data-src="https://user-images.githubusercontent.com/72421091/181377885-2f6ccc84-7785-457d-8ad6-7d8529e2189a.png" alt="Pasted image 20220727204544" data-proofer-ignore></p><p>We did some testing with the app, now let’s switch to some reversing with the apk file.</p><h1 id="what-is-an-apk-file-">What is an apk file ?</h1><p>A file with the APK file extention is an Android Package file that’s used to distribute apps on Google’s Android operating system</p><p>APK files are saved in the ZIP format and are typically downloaded directly to Android devices, usually via Google Play, but can also be found on other websites.</p><h1 id="apkleaks">APKLeaks</h1><p>There is a tool called APKLeaks that helps with getting urls, endpoints, and secrets from our apk files. It’s used by bug bounty hunters  https://github.com/dwisiswant0/apkleaks</p><p><img data-src="https://user-images.githubusercontent.com/72421091/181377965-2ab932d0-227d-4fcc-a4c1-1d910c22bfda.png" alt="Pasted image 20220727214356" data-proofer-ignore></p><p>As we can see, there are some android xml files and a domain used with a endpoint or maybe a directory /appRoot.</p><p><strong>Expectation :</strong></p><p>And then you’ll be like, “emm, some juicy cash money for my bug bounty report :smirk: “</p><p><strong>Reality :</strong> :skull:</p><p><img data-src="https://user-images.githubusercontent.com/72421091/181378000-3ec55722-307f-4d9a-ae97-40020ed492ef.png" alt="Pasted image 20220727213844" data-proofer-ignore></p><h1 id="apktool">Apktool</h1><p>It’s a tool for reverse engineering Android apk files. We are going to use it to extract files from our apk. You can check the documentation for more details https://ibotpeaches.github.io/Apktool/</p><p>You can see instructions here to install it.</p><p>As i’m using Kali Linux, there is a package for it. We can use apt to install  <code class="language-plaintext highlighter-rouge">sudo apt install apktool</code></p><p>Let’s extract the apk file </p><p><img data-src="https://user-images.githubusercontent.com/72421091/181378192-017067a5-c5f2-4a3a-8d8c-4779e1c62388.png" alt="Pasted image 20220727210300" data-proofer-ignore></p><p><img data-src="https://user-images.githubusercontent.com/72421091/181378221-5b062c81-f451-41dd-bd7b-c3d6477f6ff7.png" alt="Pasted image 20220727210635" data-proofer-ignore></p><ul><li>The AndroidManifest.xml is important for security research, it’s has the permissions required by the app, which can be abused if it’s not configured properly. We can read more about that  : </ul><p>  https://pentestlab.blog/2017/01/24/security-guidelines-for-android-manifest-files/ </p><p>  https://www.briskinfosec.com/blogs/blogsdetail/Android-Manifest-File-Analysis-101</p><ul><li>Our focus today is the classes.dex file. The code is packed into .dex files. Dex stands for Dalvik Executable. A Dex file contains code that is ultimately executed by the Android Runtime. We can convert dex files to jar files using the dex2jar tool.</ul><p><img data-src="https://user-images.githubusercontent.com/72421091/181378236-c9664514-88dd-4b93-a3fb-49682ceaa967.png" alt="Pasted image 20220727211329" data-proofer-ignore></p><p>Now let’s decompile the jar file using JD-GUI <a href="http://java-decompiler.github.io/">http://java-decompiler.github.io/</a></p><p><img data-src="https://user-images.githubusercontent.com/72421091/181378255-07897f33-0b34-449e-b1d1-8df799b4b6dd.png" alt="Pasted image 20220727211659" data-proofer-ignore></p><p>As we can see here, the application configuration details.</p><p>Now let’s go to our target, the MainActivity.class. It’s like the main code from our Android app. We can read more about Android app development to get more details about it.</p><p>MainActivity.class</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hacker101.level13</span><span class="o">;</span>  
  
<span class="kn">import</span> <span class="nn">android.net.Uri</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">android.support.v7.app.AppCompatActivity</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">android.webkit.WebView</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">android.webkit.WebViewClient</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">java.math.BigInteger</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">java.security.MessageDigest</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>  
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="nc">AppCompatActivity</span> <span class="o">{</span>  
  <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">paramBundle</span><span class="o">)</span> <span class="o">{</span>  
    <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">paramBundle</span><span class="o">);</span>  
    <span class="n">setContentView</span><span class="o">(</span><span class="mi">2131296284</span><span class="o">);</span>  
    <span class="nc">WebView</span> <span class="n">webView</span> <span class="o">=</span> <span class="o">(</span><span class="nc">WebView</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="mi">2131165328</span><span class="o">);</span>  
    <span class="n">webView</span><span class="o">.</span><span class="na">setWebViewClient</span><span class="o">(</span><span class="k">new</span> <span class="nc">WebViewClient</span><span class="o">());</span>  
    <span class="nc">Uri</span> <span class="n">uri</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">().</span><span class="na">getData</span><span class="o">();</span>  
    <span class="nc">String</span> <span class="n">str1</span> <span class="o">=</span> <span class="s">"https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot"</span><span class="o">;</span>  
    <span class="nc">String</span> <span class="n">str3</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>  
    <span class="k">if</span> <span class="o">(</span><span class="n">uri</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
      <span class="n">str3</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">substring</span><span class="o">(</span><span class="mi">28</span><span class="o">);</span>  
      <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot"</span><span class="o">);</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str3</span><span class="o">);</span>  
      <span class="n">str1</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>  
    <span class="o">}</span>   
    <span class="nc">String</span> <span class="n">str2</span> <span class="o">=</span> <span class="n">str1</span><span class="o">;</span>  
    <span class="k">if</span> <span class="o">(!</span><span class="n">str1</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"?"</span><span class="o">))</span> <span class="o">{</span>  
      <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str1</span><span class="o">);</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"?"</span><span class="o">);</span>  
      <span class="n">str2</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>  
    <span class="o">}</span>   
    <span class="k">try</span> <span class="o">{</span>  
      <span class="nc">MessageDigest</span> <span class="n">messageDigest</span> <span class="o">=</span> <span class="nc">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SHA-256"</span><span class="o">);</span>  
      <span class="n">messageDigest</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="s">"s00p3rs3cr3tk3y"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>  
      <span class="n">messageDigest</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">str3</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>  
      <span class="kt">byte</span><span class="o">[]</span> <span class="n">arrayOfByte</span> <span class="o">=</span> <span class="n">messageDigest</span><span class="o">.</span><span class="na">digest</span><span class="o">();</span>  
      <span class="nc">BigInteger</span> <span class="n">bigInteger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BigInteger</span><span class="o">();</span>  
      <span class="k">this</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">arrayOfByte</span><span class="o">);</span>  
      <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%064x"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[]</span> <span class="o">{</span> <span class="n">bigInteger</span> <span class="o">});</span>  
      <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>  
      <span class="k">this</span><span class="o">();</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str2</span><span class="o">);</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&amp;hash="</span><span class="o">);</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>  
      <span class="n">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>  
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">NoSuchAlgorithmException</span> <span class="n">noSuchAlgorithmException</span><span class="o">)</span> <span class="o">{</span>  
      <span class="n">noSuchAlgorithmException</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>  
    <span class="o">}</span>   
  <span class="o">}</span>  
<span class="o">}</span>
</pre></table></code></div></div><h1 id="now-we-have-the-source-code-what-to-do-">Now we have the source code what to do ?</h1><p><img data-src="https://user-images.githubusercontent.com/72421091/181378309-fde968b3-55e1-4828-9157-d77762c8bfca.png" alt="Pasted image 20220727212805" data-proofer-ignore></p><p>It’s just the app code for us x)</p><p>As we see from our first interaction with app http requests, we need to understand how to get the hash to access /appRoot/flagBearer or maybe use it for other things.</p><p>Start analyzing</p><ul><li>First we can see the libraires imported and used.<li>The app sets a webview to be able to see urls.<li>Start to build a url insied URI class probably https://developer.android.com/reference/java/net/URI</ul><p>We can see the code when URI is null</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>    <span class="k">if</span> <span class="o">(</span><span class="n">uri</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
      <span class="n">str3</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">substring</span><span class="o">(</span><span class="mi">28</span><span class="o">);</span>  
      <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot"</span><span class="o">);</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str3</span><span class="o">);</span>  
      <span class="n">str1</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>  
    <span class="o">}</span>
</pre></table></code></div></div><ul><li>str1 = “https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot”;<li>build the str2 with str1 + append “?”<li>Try to do some fancy encryption for a string to convert it to a hash and build the final URL</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>    <span class="k">try</span> <span class="o">{</span>  
      <span class="nc">MessageDigest</span> <span class="n">messageDigest</span> <span class="o">=</span> <span class="nc">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SHA-256"</span><span class="o">);</span>  
      <span class="n">messageDigest</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="s">"s00p3rs3cr3tk3y"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>  
      <span class="n">messageDigest</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">str3</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>  
      <span class="kt">byte</span><span class="o">[]</span> <span class="n">arrayOfByte</span> <span class="o">=</span> <span class="n">messageDigest</span><span class="o">.</span><span class="na">digest</span><span class="o">();</span>  
      <span class="nc">BigInteger</span> <span class="n">bigInteger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BigInteger</span><span class="o">();</span>  
      <span class="k">this</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">arrayOfByte</span><span class="o">);</span>  
      <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%064x"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[]</span> <span class="o">{</span> <span class="n">bigInteger</span> <span class="o">});</span>  
      <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>  
      <span class="k">this</span><span class="o">();</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str2</span><span class="o">);</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&amp;hash="</span><span class="o">);</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>  
      <span class="n">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>  
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">NoSuchAlgorithmException</span> <span class="n">noSuchAlgorithmException</span><span class="o">)</span> <span class="o">{</span>  
      <span class="n">noSuchAlgorithmException</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>  
    <span class="o">}</span>
</pre></table></code></div></div><p>If you can’t understand what the code does, you can simply create a Java code and start importing the used libraries and print each line to see the output. We need to add used string variables and also set a URI value for testing.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">java.math.BigInteger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.MessageDigest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>
<span class="kd">class</span> <span class="nc">test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// here we need to the add used URI and string values.</span>
    <span class="c1">// put the try catch and start analysing using System.out.println()</span>
    <span class="o">}</span>
    
    <span class="o">}</span>
</pre></table></code></div></div><p>After doing some testing, let’s get back to our way of finding the hash.</p><ul><li>for URI, I abused the function that shows how the URI is built if it’s null.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>    <span class="k">if</span> <span class="o">(</span><span class="n">uri</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
      <span class="n">str3</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">substring</span><span class="o">(</span><span class="mi">28</span><span class="o">);</span>  
      <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot"</span><span class="o">);</span>  
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str3</span><span class="o">);</span>  
      <span class="n">str1</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>  
    <span class="o">}</span>
</pre></table></code></div></div><p>As we can see, it does a substring of 28 and takes the last part https://www.javatpoint.com/substring</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="no">URI</span> <span class="o">=</span> <span class="s">"AAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBB"</span><span class="o">;</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="no">URI</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">substring</span><span class="o">(</span><span class="mi">28</span><span class="o">));</span>
        
        <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>BBBBBBB
</pre></table></code></div></div><p>for the str1 we have an URL + str3 (URI.toString().substring(28))</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot + str3
</pre></table></code></div></div><p>We use “BBBB” for str3 at the moment. We can see that the beginning is probably a “/”</p><p>Now str1 = https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot/BBBB</p><p>The str2 is str1 + “?”</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot/BBBB?
</pre></table></code></div></div><p>At the encryption part, we can see that the code appends another <code class="language-plaintext highlighter-rouge">&amp;hash=</code> and the hash value to the final string.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>      stringBuilder.append(str2);  
      stringBuilder.append("&amp;hash=");  
      stringBuilder.append(str);
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot/BBBB?hash=X
</pre></table></code></div></div><p>It looks familiar, right ? If we go back to our requests analysis at the beginning, we can see the same format.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot?&amp;hash=61f4518d844a9bd27bb971e55a23cd6cf3a9f5ef7f46285461cf6cf135918a1a
</pre></table></code></div></div><p>For the BBBB part, it’s possible that it has flagBearer or /appRoot/flagBearer. URI Format can be <strong>URL/appRoot/flagBearer</strong></p><p>Now let’s go for our solution. I used the same Main code with some modifications to get our hash. We can use an online Java compiler or execute it from your system if you have Java installed.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">java.math.BigInteger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.MessageDigest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>


<span class="kd">class</span> <span class="nc">get_hash</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">uri</span> <span class="o">=</span> <span class="s">"AAAAAAAAAAAAAAAAAAAAAAAAAAAA/flagBearer"</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">str1</span> <span class="o">=</span> <span class="s">"https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot"</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">str3</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">uri</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">str3</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">substring</span><span class="o">(</span><span class="mi">28</span><span class="o">);</span>
      <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot"</span><span class="o">);</span>
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str3</span><span class="o">);</span>
      <span class="n">str1</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span> 
    <span class="nc">String</span> <span class="n">str2</span> <span class="o">=</span> <span class="n">str1</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">str1</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"?"</span><span class="o">))</span> <span class="o">{</span>
      <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str1</span><span class="o">);</span>
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"?"</span><span class="o">);</span>
      <span class="n">str2</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span> 
    <span class="k">try</span> <span class="o">{</span>
      <span class="nc">MessageDigest</span> <span class="n">messageDigest</span> <span class="o">=</span> <span class="nc">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SHA-256"</span><span class="o">);</span>
      <span class="n">messageDigest</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="s">"s00p3rs3cr3tk3y"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
      <span class="n">messageDigest</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">str3</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
      <span class="kt">byte</span><span class="o">[]</span> <span class="n">arrayOfByte</span> <span class="o">=</span> <span class="n">messageDigest</span><span class="o">.</span><span class="na">digest</span><span class="o">();</span>
      <span class="nc">BigInteger</span> <span class="n">bigInteger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BigInteger</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">arrayOfByte</span><span class="o">);</span>
      <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%064x"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[]</span> <span class="o">{</span> <span class="n">bigInteger</span> <span class="o">});</span>
      <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str2</span><span class="o">);</span>
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&amp;hash="</span><span class="o">);</span>
      <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">NoSuchAlgorithmException</span> <span class="n">noSuchAlgorithmException</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">noSuchAlgorithmException</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span> 
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Output</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://86c65fe0ecf5117f91f7d2eaf9adf25e.ctf.hacker101.com/appRoot/flagBearer?&amp;hash=8743a18df6861ced0b7d472b34278dc29abba81b3fa4cf836013426d6256bd5e
</pre></table></code></div></div><p>Let’s visit the url</p><p><img data-src="https://user-images.githubusercontent.com/72421091/181378516-3d752cc4-9c1b-46ae-b975-0d5cdc23843a.png" alt="Pasted image 20220727222124" data-proofer-ignore></p><p>We were able to solve the challenge with right hash value.</p><h1 id="conclusion">Conclusion</h1><p>I hope you find this article useful. You can learn more about Android application pentesting. There are many interesting attacks. You can take a look at :</p><ul><li>https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting<li>ANDROID APP SECURITY BASICS https://www.youtube.com/watch?v=a8Gh7d8GebA<li>HACKING ANDROID WebViews https://www.youtube.com/watch?v=qS5PkC-37io</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>Writeup</a>, <a href='/categories/android/'>Android</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/android/" class="post-tag no-text-decoration" >Android</a> <a href="/tags/bug-bounty/" class="post-tag no-text-decoration" >Bug Bounty</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Android+Applications+Pentesting%2C+Intentional+Exercise+from+Hackerone+platform+-+BaadMaro&url=https%3A%2F%2Fbaadmaro.github.io%2Fposts%2FAndroid-Applications-Pentesting%2C-Intentional-Exercise-from-Hackerone-platform%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Android+Applications+Pentesting%2C+Intentional+Exercise+from+Hackerone+platform+-+BaadMaro&u=https%3A%2F%2Fbaadmaro.github.io%2Fposts%2FAndroid-Applications-Pentesting%2C-Intentional-Exercise-from-Hackerone-platform%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fbaadmaro.github.io%2Fposts%2FAndroid-Applications-Pentesting%2C-Intentional-Exercise-from-Hackerone-platform%2F&text=Android+Applications+Pentesting%2C+Intentional+Exercise+from+Hackerone+platform+-+BaadMaro" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/DGSSI-CTF-PRO-Italy-Writeup/">DGSSI CTF PRO 2024 - Italy Writeup</a><li><a href="/posts/Discourse-CVE-2023-47119-Building-a-CVE-POC-from-commits-changes/">Discourse CVE-2023-47119 - Building a CVE POC from commits changes</a><li><a href="/posts/Android-Applications-Pentesting,-Intentional-Exercise-from-Hackerone-platform/">Android Applications Pentesting, Intentional Exercise from Hackerone platform</a><li><a href="/posts/Bypass-captcha-using-OCR-on-Dolibarr-login-page/">Bypass captcha using OCR on Dolibarr login page</a><li><a href="/posts/IoT-Pentesting-with-Teltonika-RUT9XX/">IoT Pentesting with Teltonika RUT9XX</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/bug-bounty/">Bug Bounty</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/dgssi/">DGSSI</a> <a class="post-tag" href="/tags/discourse/">Discourse</a> <a class="post-tag" href="/tags/dolibarr/">Dolibarr</a> <a class="post-tag" href="/tags/fat/">FAT</a> <a class="post-tag" href="/tags/firmware/">Firmware</a> <a class="post-tag" href="/tags/router/">router</a> <a class="post-tag" href="/tags/writeup/">Writeup</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/IoT-Pentesting-with-Teltonika-RUT9XX/"><div class="card-body"> <em class="small" data-ts="1658707200" data-df="ll" > Jul 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>IoT Pentesting with Teltonika RUT9XX</h3><div class="text-muted small"><p> Today we are going to practice some IoT pentesting with a device called RUT950 as an example. I’ll explain different techniques used in IoT pentesting including emulation, firmware analysis, explo...</p></div></div></a></div><div class="card"> <a href="/posts/DGSSI-CTF-PRO-Italy-Writeup/"><div class="card-body"> <em class="small" data-ts="1711411200" data-df="ll" > Mar 26, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DGSSI CTF PRO 2024 - Italy Writeup</h3><div class="text-muted small"><p> The lab was included in the professional DGSSI CTF hosed in SecDojo platform on February 7, 2024. https://www.linkedin.com/showcase/dgssi-ctf-2024/ Naples machine We start our enumeration wi...</p></div></div></a></div><div class="card"> <a href="/posts/Discourse-CVE-2023-47119-Building-a-CVE-POC-from-commits-changes/"><div class="card-body"> <em class="small" data-ts="1699833600" data-df="ll" > Nov 13, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Discourse CVE-2023-47119 - Building a CVE POC from commits changes</h3><div class="text-muted small"><p> I was checking for some Discourse vulnerabilities, and I saw that a new CVE was dropped on 11/10/2023 CVE-2023-47119 The details didn’t mention any POC, so I did some analysis based on the source...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/IoT-Pentesting-with-Teltonika-RUT9XX/" class="btn btn-outline-primary" prompt="Older"><p>IoT Pentesting with Teltonika RUT9XX</p></a> <a href="/posts/Bypass-captcha-using-OCR-on-Dolibarr-login-page/" class="btn btn-outline-primary" prompt="Newer"><p>Bypass captcha using OCR on Dolibarr login page</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "BaadMaro/baadmaro.github.io", "data-repo-id": "R_kgDOHRG0bg", "data-category": "General", "data-category-id": "DIC_kwDOHRG0bs4CO51Z", "data-mapping": "title", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/BaadMaro">BaadMaro</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/bug-bounty/">Bug Bounty</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/dgssi/">DGSSI</a> <a class="post-tag" href="/tags/discourse/">Discourse</a> <a class="post-tag" href="/tags/dolibarr/">Dolibarr</a> <a class="post-tag" href="/tags/fat/">FAT</a> <a class="post-tag" href="/tags/firmware/">Firmware</a> <a class="post-tag" href="/tags/router/">router</a> <a class="post-tag" href="/tags/writeup/">Writeup</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-JHN65JPH4C"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-JHN65JPH4C'); }); </script>
